import numpy as np
import torch

general_labels_map = {'HEAD_TOP': 'ARIEL',
                      'TOPBACK': 'C7',
                      'NECK_BASE': 'C7',
                      'CHEST': 'CLAV',
                      'UPTHRX': 'CLAV',
                      'L_ANKLE': 'LANK',
                      'L_ANK': 'LANK',
                      'L_UPBACK': 'LBAK',
                      'LBAC': 'LBAK',
                      'LBAC-1': 'LBAK',
                      'L_BICEP': 'LBCEP',
                      'L_EAR': 'LBHD',
                      'NEWLSHO': 'LBCEP',
                      'NEWRSHO': 'RBCEP',
                      'NEWLBAC': 'LNWST',
                      'NEWRBAC': 'RNWST',
                      'LBSHO': 'LBSH',
                      'L_B_SHOULDER': 'LBSH',
                      'L_B_WAIST': 'LBWT',
                      'L_BWT': 'LBWT',
                      'LPSI': 'LBWT',
                      'L_CALF': 'LCLF',
                      'LIBH': 'LEBHI',
                      'LMBH': 'LEBHM',
                      'LPBH': 'LEBHP',
                      'LRBH': 'LEBHR',
                      'LIDIP': 'LEIDIP',
                      'L_ELBOW': 'LELB',
                      'L_INELBOW': 'LELBIN',
                      'LILB': 'LELBIN',
                      'LIEL': 'LELBIN',
                      'LMDIP': 'LEMDIP',
                      'LPDIP': 'LEPDIP',
                      'LPPIP': 'LEPPIP',
                      'LPTIP': 'LEPTIP',
                      'LRDIP': 'LERDIP',
                      'LRPIP': 'LERPIP',
                      'LRTIP': 'LERTIP',
                      'LTMP': 'LETMP',
                      'LTPIPI': 'LETPIPIN',
                      'LTPIPO': 'LTHM4',
                      'HEAD_OFFSET': 'LFHD',
                      'L_PINKY': 'LFIN',
                      'LOHAND': 'LFIN',
                      'L_FIN': 'LFIN',
                      'LPHLX5': 'LFIN',
                      'L_FOREARM': 'LFRM',
                      'LARM': 'LFRM',
                      'LFRA': 'LFRM',
                      'LWRE': 'LFRM',
                      'LWRI': 'LFRMIN',
                      'L_F_SHOULDER': 'LFSH',
                      'LASI': 'LFWT',
                      'L_F_WAIST': 'LFWT',
                      'L_FWT': 'LFWT',
                      'L_HEEL': 'LHEE',
                      'LHEL': 'LHEE',
                      'LANKIN': 'LHEEI',
                      'LANKI': 'LHEEI',
                      'LIPIP': 'LIDX1',
                      'LEIPIP': 'LIDX1',
                      'LITIP': 'LIDX3',
                      'LEITIP': 'LIDX3',
                      'L_INWRIST': 'LIWR',
                      'LWRA': 'LIWR',
                      'LWRST': 'LIWR',
                      'L_OUTKNEE': 'LKNE',
                      'L_KNEE': 'LKNE',
                      'L_INKNEE': 'LKNI',
                      'LKNEIN': 'LKNI',
                      'LMPIP': 'LMID1',
                      'LEMPIP': 'LMID1',
                      'LMTIP': 'LMID3',
                      'LEMTIP': 'LMID3',
                      'L_BIGTOE': 'LMT1',
                      'L_PINKYTOE': 'LMT5',
                      'L_OUTWRIST': 'LOWR',
                      'LWRB': 'LOWR',
                      'L_WRIST': 'LOWR',
                      # 'LEPTIP': 'LPNK3',
                      'LMWT': 'LPRFWT',
                      'LTOE5': 'LRSTBEEF',
                      'L_MIDBACK': 'LSCAP',
                      'L_SHIN': 'LSHN',
                      'LSHIN': 'LSHN',
                      'L_SHOULDER': 'LSHOUP',
                      'LHIP': 'LTHI',
                      'L_HIP': 'LTHI',
                      'L_HAM': 'LTHI',
                      'L_THIGH': 'LTHILO',
                      'LTHIGH': 'LTHILO',
                      'LTTIP': 'LTHM3',
                      # 'LETTIP': 'LTHM3',
                      'L_THUMB': 'LTHMB',
                      'LIHAND': 'LTHMB',
                      'LPHLX1': 'LTHMB',
                      'LLEG': 'LTIB',
                      'L_TOETIP': 'LTOE',
                      'LTOE1': 'LTOE',
                      'L_TRICEP': 'LUPA',
                      'R_ANKLE': 'RANK',
                      'R_ANK': 'RANK',
                      'R_UPBACK': 'RBAK',
                      'RBAC': 'RBAK',
                      'RBAC-1': 'RBAK',
                      'R10': 'RBAK',
                      'OFFSET': 'RBAK',
                      'R_BICEP': 'RBCEP',
                      'R_EAR': 'RBHD',
                      'RBSHO': 'RBSH',
                      'R_B_SHOULDER': 'RBSH',
                      'RPSI': 'RBWT',
                      'R_B_WAIST': 'RBWT',
                      'R_BWT': 'RBWT',
                      'R_CALF': 'RCLF',
                      'R_ELBOW': 'RELB',
                      'R_INELBOW': 'RELBIN',
                      'RILB': 'RELBIN',
                      'RIEL': 'RELBIN',
                      'R_PINKY': 'RFIN',
                      'ROHAND': 'RFIN',
                      'R_FIN': 'RFIN',
                      'RPHLX5': 'RFIN',
                      'R_FOREARM': 'RFRM',
                      'RARM': 'RFRM',
                      'RFRA': 'RFRM',
                      'RWRE': 'RFRM',
                      'RWRI': 'RFRMIN',
                      'R_F_SHOULDER': 'RFSH',
                      'RASI': 'RFWT',
                      'R_F_WAIST': 'RFWT',
                      'R_FWT': 'RFWT',
                      'R_HEEL': 'RHEE',
                      'RHEL': 'RHEE',
                      'RANKIN': 'RHEEI',
                      'RANKI': 'RHEEI',
                      'RIBH': 'RIBHI',
                      'RMBH': 'RIBHM',
                      'RPBH': 'RIBHP',
                      'RRBH': 'RIBHR',
                      'RITIP': 'RIDX3',
                      'RIITIP': 'RIDX3',
                      'RIDIP': 'RIIDIP',
                      'RIPIP': 'RIIPIP',
                      'RMDIP': 'RIMDIP',
                      'RMPIP': 'RIMPIP',
                      'RPDIP': 'RIPDIP',
                      'RPPIP': 'RIPPIP',
                      'RRDIP': 'RIRDIP',
                      'RRPIP': 'RIRPIP',
                      'RTMP': 'RITMP',
                      'RTPIPI': 'RITPIPIN',
                      'RTPIPO': 'RITPIPOUT',
                      'RTTIP': 'RITTIP',
                      'R_INWRIST': 'RIWR',
                      'RWRA': 'RIWR',
                      'R_OUTKNEE': 'RKNE',
                      'R_KNEE': 'RKNE',
                      'R_INKNEE': 'RKNI',
                      'RKNEIN': 'RKNI',
                      'RMTIP': 'RMID3',
                      'RIMTIP': 'RMID3',
                      'R_BIGTOE': 'RMT1',
                      'R_PINKYTOE': 'RMT5',
                      'R_OUTWRIST': 'ROWR',
                      'RWRB': 'ROWR',
                      'R_WRIST': 'ROWR',
                      'RPTIP': 'RPNK3',
                      'RIPTIP': 'RPNK3',
                      'RMWT': 'RPRFWT',
                      'RRTIP': 'RRNG3',
                      'RIRTIP': 'RRNG3',
                      'RTOE5': 'RRSTBEEF',
                      'R_MIDBACK': 'RSCAP',
                      'R_SHIN': 'RSHN',
                      'RSHIN': 'RSHN',
                      'R_SHOULDER': 'RSHOUP',
                      'RHIP': 'RTHI',
                      'R_HIP': 'RTHI',
                      'R_HAM': 'RTHI',
                      'R_THIGH': 'RTHILO',
                      'RTHIGH': 'RTHILO',
                      'R_THUMB': 'RTHMB',
                      'RIHAND': 'RTHMB',
                      'RPHLX1': 'RTHMB',
                      'RLEG': 'RTIB',
                      'R_TOETIP': 'RTOE',
                      'RTOE1': 'RTOE',
                      'R_TRICEP': 'RUPA',
                      'STERNUM': 'STRN',
                      'SETRNUM': 'STRN',
                      'LOTHRX': 'STRN',
                      'LOBACK': 'T10',
                      'MIDBACK': 'T8',
                      'MID_BACK': 'T8',
                      'ghost': 'nan',
                      'NaN': 'nan',
                      }

all_marker_vids ={'ARIEL': 411,
    'BHEAD': 384,
    'C7': 3470,
    'CHIN': 3052,
    'CLAV': 3171,
    'FHEAD': 335,
    'LAEL': 1655,
    'LANK': 3327,
    'LAOL': 1736,
    'LBAK': 1812,
    'LBCEP': 628,
    'LBHD': 182,
    'LBLLY': 1345,
    'LBSH': 2940,
    'LBTHI': 988,
    'LBUM': 3116,
    'LBUST': 3040,
    'LBUSTLO': 1426,
    'LBWT': 3122,
    'LCHEECK': 239,
    'LCHST': 595,
    'LCLAV': 1298,
    'LCLF': 1103,
    'LEBHI': 2274,
    'LEBHM': 2270,
    'LEBHP': 2193,
    'LEBHR': 2293,
    'LEIDIP': 2295,
    'LELB': 1666,
    'LELBIN': 1725,
    'LEMDIP': 2407,
    'LEPDIP': 2635,
    'LEPPIP': 2590,
    'LEPTIP': 2674,
    'LERDIP': 2518,
    'LERPIP': 2478,
    'LERTIP': 2557,
    'LETMP': 2070,
    'LETPIPIN': 2713,
    'LETPIPOUT': 2711,
    'LFHD': 0,
    'LFIN': 2174,
    'LFOOT': 3365,
    'LFRM': 1568,
    'LFRM2': 1741,
    'LFRM2IN': 1953,
    'LFRMIN': 1728,
    'LFSH': 1317,
    'LFTHI': 874,
    'LFTHIIN': 1368,
    'LFWT': 857,
    'LHEE': 3387,
    'LHEEI': 3432,
    'LHPS': 2176,
    'LHTS': 2134,
    'LIDX1': 2204,
    'LIDX2': 2283,
    'LIDX3': 2320,
    'LIWR': 2112,
    'LKNE': 1053,
    'LKNI': 1058,
    'LMHAND': 2212,
    'LMID1': 2389,
    'LMID2': 2406,
    'LMID3': 2446,
    'LMT1': 3336,
    'LMT5': 3346,
    'LNECK': 298,
    'LNWST': 1323,
    'LOWR': 2108,
    'LPNK1': 2628,
    'LPNK2': 2634,
    'LPNK3': 2674,
    'LPRFWT': 2915,
    'LRNG1': 2499,
    'LRNG2': 2517,
    'LRNG3': 2564,
    'LRSTBEEF': 3314,
    'LSCAP': 1252,
    'LSHN': 1082,
    'LSHNIN': 1153,
    'LSHO': 1861,
    'LSHOUP': 742,
    'LTHI': 1454,
    'LTHILO': 850,
    'LTHM1': 2251,
    'LTHM2': 2706,
    'LTHM3': 2730,
    'LTHM4': 2732,
    'LTHMB': 2224,
    'LTIB': 1112,
    'LTIBIN': 1105,
    'LTIP': 1100,
    'LTOE': 3233,
    'LUPA': 1443,
    'LUPA2': 1315,
    'LWPS': 1943,
    'LWTS': 1922,
    'MBLLY': 1769,
    'MBWT': 3022,
    'MFWT': 3503,
    'MNECK': 3057,
    'RAEL': 5087,
    'RANK': 6728,
    'RAOL': 5127,
    'RBAK': 5273,
    'RBCEP': 4116,
    'RBHD': 3694,
    'RBLLY': 4820,
    'RBSH': 6399,
    'RBTHI': 4476,
    'RBUM': 6540,
    'RBUST': 6488,
    'RBUSTLO': 4899,
    'RBWT': 6544,
    'RCHEECK': 3749,
    'RCHST': 4085,
    'RCLAV': 4780,
    'RCLF': 4589,
    'RELB': 5135,
    'RELBIN': 5194,
    'RFHD': 3512,
    'RFIN': 5635,
    'RFOOT': 6765,
    'RFRM': 5037,
    'RFRM2': 5210,
    'RFRM2IN': 5414,
    'RFRMIN': 5197,
    'RFSH': 4798,
    'RFTHI': 4360,
    'RFTHIIN': 4841,
    'RFWT': 4343,
    'RHEE': 6786,
    'RHEEI': 6832,
    'RHPS': 5525,
    'RHTS': 5595,
    'RIBHI': 5735,
    'RIBHM': 5731,
    'RIBHP': 5655,
    'RIBHR': 5752,
    'RIDX1': 5722,
    'RIDX2': 5744,
    'RIDX3': 5781,
    'RIIDIP': 5757,
    'RIIPIP': 5665,
    'RIMDIP': 5869,
    'RIMPIP': 5850,
    'RIPDIP': 6097,
    'RIPPIP': 6051,
    'RIRDIP': 5980,
    'RIRPIP': 5939,
    'RITMP': 5531,
    'RITPIPIN': 6174,
    'RITPIPOUT': 6172,
    'RITTIP': 6191,
    'RIWR': 5573,
    'RKNE': 4538,
    'RKNI': 4544,
    'RMHAND': 5674,
    'RMID1': 5861,
    'RMID2': 5867,
    'RMID3': 5907,
    'RMT1': 6736,
    'RMT5': 6747,
    'RNECK': 3810,
    'RNWST': 4804,
    'ROWR': 5568,
    'RPNK1': 6089,
    'RPNK2': 6095,
    'RPNK3': 6135,
    'RPRFWT': 6375,
    'RRNG1': 5955,
    'RRNG2': 5978,
    'RRNG3': 6018,
    'RRSTBEEF': 6682,
    'RSCAP': 4735,
    'RSHN': 4568,
    'RSHNIN': 4638,
    'RSHO': 5322,
    'RSHOUP': 4230,
    'RTHI': 4927,
    'RTHILO': 4334,
    'RTHM1': 5714,
    'RTHM2': 6168,
    'RTHM3': 6214,
    'RTHM4': 6193,
    'RTHMB': 5686,
    'RTIB': 4598,
    'RTIBIN': 4593,
    'RTIP': 4585,
    'RTOE': 6633,
    'RUPA': 4918,
    'RUPA2': 4794,
    'RWPS': 5526,
    'RWTS': 5690,
    'SACR': 1783,
    'STRN': 3506,
    'T10': 3016,
    'T8': 3508}




PICK_LABEL=['ARIEL', 'LFHD', 'LBHD', 'RFHD', 'RBHD', 'C7', 'T10', 'CLAV', 'STRN', 'LFSH', 'LBSH', 'LUPA', 'LELB', 'LIEL', 'LFRM', 'LIWR', 'LOWR', 'LIHAND', 'LOHAND', 'RFSH', 'RBSH', 'RUPA', 'RELB', 'RIEL', 'RFRM', 'RIWR', 'ROWR', 'RIHAND', 'ROHAND', 'LFWT', 'MFWT', 'RFWT', 'LBWT', 'MBWT', 'RBWT', 'LTHI', 'LKNE', 'LKNI', 'LSHN', 'LANK', 'LHEL', 'LMT5', 'LMT1', 'LTOE', 'RTHI', 'RKNE', 'RKNI', 'RSHN', 'RANK', 'RHEL', 'RMT5', 'RMT1', 'RTOE']

PICK_INDEX=torch.tensor([  411,    0,  182, 3512, 3694, 3470, 3016, 3171, 3506, 1317, 2940, 1443,
        1666, 1725, 1568, 2112, 2108, 2177, 2155, 4798, 6399, 4918, 5135, 5194,
        5037, 5573, 5568, 5638, 5614,  857, 3503, 4343, 3122, 3022, 6544, 1454,
        1053, 1058, 1082, 3327, 3393, 3346, 3336, 3233, 4927, 4538, 4544, 4568,
        6728, 6793, 6747, 6736, 6633], dtype=torch.long)


finetune_PICK_LABEL={'ARIEL': 411, 'LFHD': 135, 'LBHD': 386, 'RFHD': 3645, 'RBHD': 3691, 'C7': 1217, 'T10': 752, 'CLAV': 3073, 'STRN': 3077, 'LFSH': 1317, 'LBSH': 1825, 
'LUPA': 2895, #
'LELB': 1656, 'LIEL': 1684, 'LFRM': 1600, 'LIWR': 2229, 'LOWR': 2059, 'LIHAND': 2044, 'LOHAND': 2061, 'RFSH': 4796, 'RBSH': 5273, 
'RUPA': 4911, # 
'RELB': 5135, 'RIEL': 5117, 'RFRM': 5154, 'RIWR': 5534, 'ROWR': 5440, 'RIHAND': 5674, 'ROHAND': 5633, 'LFWT': 857, 'MFWT': 3503, 'RFWT': 6386, 'LBWT': 2918, 'MBWT': 3021, 'RBWT': 6370, 'LTHI': 872, 'LKNE': 1010, 'LKNI': 1016, 'LSHN': 1083, 'LANK': 3204, 'LHEL': 3387, 
'LMT5': 3230,#
'LMT1': 3235, 'LTOE': 3216, 'RTHI': 4358, 'RKNE': 4495, 'RKNI': 4506, 'RSHN': 4599, 'RANK': 6607, 'RHEL': 6786, 'RMT5': 6668, 'RMT1': 6647, 'RTOE': 6638}

finetune_PICK_INDEX=torch.tensor([411, 135, 386, 3645, 3691, 1217, 752, 3073, 3077, 1317, 1825, 2895, 1656, 1684, 1600, 2229, 2059, 2044, 2061, 4796, 5273, 4911, 5135, 5117, 5154, 5534, 5440, 5674, 5633, 857, 3503, 6386, 2918, 3021, 6370, 872, 1010, 1016, 1083, 3204, 3387, 3230, 3235, 3216, 4358, 4495, 4506, 4599, 6607, 6786, 6668, 6647, 6638], dtype=torch.long)

distance_from_skin=0.0095
#distance_from_skin=1
# normal[53,3]
finetune_PICK_NORMAL=torch.tensor([[-1.6698e-02,  9.9975e-01, -1.4980e-02],
        [ 8.6473e-01,  2.5918e-01,  4.3019e-01],
        [ 8.3366e-01, -1.8093e-01, -5.2180e-01],
        [-7.3664e-01,  4.1545e-01,  5.3363e-01],
        [-9.2995e-01, -1.0337e-01, -3.5287e-01],
        [-1.7739e-01,  2.7386e-01, -9.4527e-01],
        [-8.1739e-02, -1.2636e-01, -9.8861e-01],
        [-2.9584e-02,  5.0370e-01,  8.6337e-01],
        [-1.9185e-02,  1.4433e-02,  9.9971e-01],
        [-2.2277e-01,  6.0632e-01,  7.6338e-01],
        [ 3.4312e-01,  3.1509e-01, -8.8486e-01],
        [ 1.0367e-01,  8.0505e-01, -5.8408e-01],
        [-8.7850e-02,  9.3804e-01,  3.3522e-01],
        [ 5.1978e-03, -9.4150e-01,  3.3697e-01],
        [-6.0368e-03,  7.1174e-01, -7.0242e-01],
        [-4.5019e-02,  4.9809e-01,  8.6596e-01],
        [-2.4262e-01, -1.7436e-01, -9.5432e-01],
        [ 1.4272e-01, -7.7804e-01,  6.1179e-01],
        [-4.9113e-02,  7.8837e-01, -6.1323e-01],
        [ 8.4025e-02,  6.5813e-01,  7.4820e-01],
        [-1.8913e-01,  4.2498e-01, -8.8522e-01],
        [-4.2326e-02,  6.9402e-01, -7.1871e-01],
        [ 8.6545e-02,  9.8681e-01, -1.3684e-01],
        [-8.7676e-02, -7.7407e-01,  6.2700e-01],
        [-2.0203e-02,  4.3285e-01, -9.0124e-01],
        [ 1.6349e-01,  4.0582e-02,  9.8571e-01],
        [ 5.8035e-03,  1.0889e-01, -9.9404e-01],
        [-1.1811e-01,  9.8399e-01,  1.3349e-01],
        [-8.8435e-02,  8.8411e-01, -4.5883e-01],
        [ 6.4043e-01,  8.5606e-04,  7.6802e-01],
        [-4.4938e-02, -9.7568e-02,  9.9421e-01],
        [-6.9214e-01,  7.6119e-02,  7.1774e-01],
        [ 6.8853e-01,  2.7645e-01, -6.7045e-01],
        [ 2.3991e-02,  3.3952e-01, -9.4029e-01],
        [-5.0787e-01,  2.7197e-01, -8.1737e-01],
        [ 8.1053e-01, -4.9513e-02,  5.8360e-01],
        [ 9.5591e-01, -7.6596e-02,  2.8348e-01],
        [-9.6551e-01, -2.3636e-01,  1.0920e-01],
        [ 9.5158e-01,  9.2822e-02, -2.9305e-01],
        [ 9.1759e-01,  6.1883e-02, -3.9269e-01],
        [-1.1306e-01,  9.2092e-02, -9.8931e-01],
        [ 6.6351e-01, -2.5352e-01,  7.0391e-01],
        [-9.0393e-01, -4.0106e-01,  1.4855e-01],
        [ 2.9488e-01,  4.8070e-01,  8.2582e-01],
        [-8.3123e-01, -1.1217e-01,  5.4449e-01],
        [-9.6585e-01, -6.6094e-02,  2.5055e-01],
        [ 7.5902e-01, -3.2165e-01,  5.6607e-01],
        [-9.8850e-01, -1.4602e-01,  3.9201e-02],
        [-9.9776e-01,  5.5552e-02,  3.7286e-02],
        [ 8.1382e-02,  7.4765e-02, -9.9387e-01],
        [-9.3991e-01, -1.8815e-01,  2.8489e-01],
        [ 4.4821e-01,  7.2060e-01,  5.2900e-01],
        [ 9.9105e-01, -1.2694e-01,  4.1325e-02]]);


#print(finetune_PICK_LABEL.values())

